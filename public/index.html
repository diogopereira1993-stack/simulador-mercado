<div class="portfolio-card" style="border-left: 4px solid #007bff; margin-bottom: 5px;">
        <div class="portfolio-row">
            <div>
                <div class="portfolio-label">Market Cap</div>
                <div class="portfolio-value" id="mkt-cap">---</div>
            </div>
            <div style="text-align: right;">
                <div class="portfolio-label">P/E Ratio</div>
                <div class="portfolio-value" id="pe-ratio">---</div>
            </div>
        </div>
        <div style="font-size: 0.8rem; text-align: center; color: #555; margin-top: 5px;">
            Valor Justo Estimado: <span id="fair-val" style="color: #007bff; font-weight: bold;">---</span> €
        </div>
    </div>

    <div class="portfolio-card" id="portfolio-box" style="opacity: 0.5;">
        <div class="portfolio-row">
            <div>
                <div class="portfolio-label">A Tua Entrada</div>
                <div class="portfolio-value" id="my-entry">---</div>
            </div>
            <div style="text-align: right;">
                <div class="portfolio-label">Resultado</div>
                <div class="portfolio-value gain-loss" id="my-pnl">0.00%</div>
            </div>
        </div>
        <div style="font-size: 0.7rem; color: #555; text-align: center; margin-top: 5px;">
            <span id="position-status">Faz o teu primeiro voto para entrar</span>
        </div>
    </div>

    <script>
        const socket = io();
        // ... (Outras variáveis iguais) ...

        // ATENÇÃO: Mudou de 'market-update' para 'market-update-light'
        socket.on('market-update-light', (data) => {
            currentMarketPrice = parseFloat(data.price);
            
            // UI Preço
            const oldPrice = parseFloat(priceDisplay.innerText.replace('€',''));
            priceDisplay.innerText = data.price + "€";
            
            // Animação Flash
            if (currentMarketPrice > oldPrice) priceDisplay.classList.add('flash-up');
            else if (currentMarketPrice < oldPrice) priceDisplay.classList.add('flash-down');
            setTimeout(() => priceDisplay.classList.remove('flash-up', 'flash-down'), 500);

            // Novos Dados Fundamentais
            document.getElementById('mkt-cap').innerText = data.marketCap + " €";
            document.getElementById('fair-val').innerText = data.fairValue;
            
            const peEl = document.getElementById('pe-ratio');
            peEl.innerText = data.peRatio;
            
            // Colorir o P/E para dar pistas aos alunos
            if (parseFloat(data.peRatio) > 40) peEl.style.color = "#ff4444"; // Caro!
            else if (parseFloat(data.peRatio) < 15) peEl.style.color = "#00ff88"; // Barato!
            else peEl.style.color = "white";

            newsText.innerText = data.news;
            
            // ... (Resto da lógica de portfolio e estado igual) ...
             if (hasEntered) updateMyPortfolio();
             if (data.isPaused) { /* ... */ } else { /* ... */ }
        });
        
        // ... (Funções vote, updateMyPortfolio, etc mantêm-se iguais) ...
    </script>
